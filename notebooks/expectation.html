<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nipun Batra">
<meta name="dcterms.date" content="2025-01-13">
<meta name="keywords" content="expectation, law of large numbers, running average, monte carlo simulation, dice simulation, bernoulli distribution, variance">
<meta name="description" content="A comprehensive exploration of mathematical expectation, running averages, and the Law of Large Numbers with practical examples including dice rolls, coin flips, and financial simulations">

<title>Mathematical Expectation and Law of Large Numbers – Probability Statistics Data Visualization Resources</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-c3c2c9e745155556954bc4da23476b10.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-c3c2c9e745155556954bc4da23476b10.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-c3c2c9e745155556954bc4da23476b10.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1b24b88b73f8b56d80a2d5a00e70f885.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-f1f85bb7dbd4314d5ad09add27c1e8f0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-1b24b88b73f8b56d80a2d5a00e70f885.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Probability Statistics Data Visualization Resources</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://nipunbatra.github.io"> 
<span class="menu-text">Instructor Homepage</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../notebooks.html"> 
<span class="menu-text">Notebooks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setting-up-the-environmentwell-use-pytorch-for-probability-distributions-numpy-for-numerical-computations-pandas-for-data-manipulation-and-matplotlib-for-visualizations." id="toc-setting-up-the-environmentwell-use-pytorch-for-probability-distributions-numpy-for-numerical-computations-pandas-for-data-manipulation-and-matplotlib-for-visualizations." class="nav-link active" data-scroll-target="#setting-up-the-environmentwell-use-pytorch-for-probability-distributions-numpy-for-numerical-computations-pandas-for-data-manipulation-and-matplotlib-for-visualizations.">Setting Up the EnvironmentWe’ll use PyTorch for probability distributions, NumPy for numerical computations, Pandas for data manipulation, and Matplotlib for visualizations.</a></li>
  <li><a href="#dice-rolling-simulation-understanding-expected-valuelets-start-with-a-classic-example---rolling-a-fair-six-sided-die.-the-theoretical-expected-value-of-a-fair-die-isex-frac1-2-3-4-5-66-frac216-3.5even-though-we-can-never-actually-roll-a-3.5-this-is-the-average-value-we-expect-over-many-rolls." id="toc-dice-rolling-simulation-understanding-expected-valuelets-start-with-a-classic-example---rolling-a-fair-six-sided-die.-the-theoretical-expected-value-of-a-fair-die-isex-frac1-2-3-4-5-66-frac216-3.5even-though-we-can-never-actually-roll-a-3.5-this-is-the-average-value-we-expect-over-many-rolls." class="nav-link" data-scroll-target="#dice-rolling-simulation-understanding-expected-valuelets-start-with-a-classic-example---rolling-a-fair-six-sided-die.-the-theoretical-expected-value-of-a-fair-die-isex-frac1-2-3-4-5-66-frac216-3.5even-though-we-can-never-actually-roll-a-3.5-this-is-the-average-value-we-expect-over-many-rolls.">Dice Rolling Simulation: Understanding Expected ValueLet’s start with a classic example - rolling a fair six-sided die. The theoretical expected value of a fair die is:<span class="math display">\[E[X] = \frac{1 + 2 + 3 + 4 + 5 + 6}{6} = \frac{21}{6} = 3.5\]</span>Even though we can never actually roll a 3.5, this is the average value we expect over many rolls.</a>
  <ul class="collapse">
  <li><a href="#observing-individual-dice-rollslets-examine-the-frequency-distribution-of-our-dice-rolls-to-see-how-they-compare-to-the-theoretical-uniform-distribution" id="toc-observing-individual-dice-rollslets-examine-the-frequency-distribution-of-our-dice-rolls-to-see-how-they-compare-to-the-theoretical-uniform-distribution" class="nav-link" data-scroll-target="#observing-individual-dice-rollslets-examine-the-frequency-distribution-of-our-dice-rolls-to-see-how-they-compare-to-the-theoretical-uniform-distribution">Observing Individual Dice RollsLet’s examine the frequency distribution of our dice rolls to see how they compare to the theoretical uniform distribution:</a></li>
  <li><a href="#computing-running-averagesnow-lets-compute-the-running-average-to-see-how-it-converges-to-the-theoretical-expectation-of-3.5" id="toc-computing-running-averagesnow-lets-compute-the-running-average-to-see-how-it-converges-to-the-theoretical-expectation-of-3.5" class="nav-link" data-scroll-target="#computing-running-averagesnow-lets-compute-the-running-average-to-see-how-it-converges-to-the-theoretical-expectation-of-3.5">Computing Running AveragesNow let’s compute the running average to see how it converges to the theoretical expectation of 3.5:</a></li>
  </ul></li>
  <li><a href="#bernoulli-distribution-and-expected-valuelets-explore-the-bernoulli-distribution-which-models-binary-outcomes-successfailure-headstails-etc..-for-a-bernoulli-random-variable-with-probability-p-of-successex-1-cdot-p-0-cdot-1-p-pso-for-a-fair-coin-p-0.5-the-expected-value-is-0.5." id="toc-bernoulli-distribution-and-expected-valuelets-explore-the-bernoulli-distribution-which-models-binary-outcomes-successfailure-headstails-etc..-for-a-bernoulli-random-variable-with-probability-p-of-successex-1-cdot-p-0-cdot-1-p-pso-for-a-fair-coin-p-0.5-the-expected-value-is-0.5." class="nav-link" data-scroll-target="#bernoulli-distribution-and-expected-valuelets-explore-the-bernoulli-distribution-which-models-binary-outcomes-successfailure-headstails-etc..-for-a-bernoulli-random-variable-with-probability-p-of-successex-1-cdot-p-0-cdot-1-p-pso-for-a-fair-coin-p-0.5-the-expected-value-is-0.5.">Bernoulli Distribution and Expected ValueLet’s explore the Bernoulli distribution, which models binary outcomes (success/failure, heads/tails, etc.). For a Bernoulli random variable with probability <span class="math inline">\(p\)</span> of success:<span class="math display">\[E[X] = 1 \cdot p + 0 \cdot (1-p) = p\]</span>So for a fair coin (<span class="math inline">\(p = 0.5\)</span>), the expected value is 0.5.</a></li>
  <li><a href="#financial-application-coin-flip-gamenow-lets-explore-a-more-complex-application---a-financial-game-based-on-coin-flips.-this-demonstrates-how-expectation-and-variance-work-together-in-risk-assessment." id="toc-financial-application-coin-flip-gamenow-lets-explore-a-more-complex-application---a-financial-game-based-on-coin-flips.-this-demonstrates-how-expectation-and-variance-work-together-in-risk-assessment." class="nav-link" data-scroll-target="#financial-application-coin-flip-gamenow-lets-explore-a-more-complex-application---a-financial-game-based-on-coin-flips.-this-demonstrates-how-expectation-and-variance-work-together-in-risk-assessment.">Financial Application: Coin Flip GameNow let’s explore a more complex application - a financial game based on coin flips. This demonstrates how expectation and variance work together in risk assessment.</a>
  <ul class="collapse">
  <li><a href="#game-setupin-this-game--each-player-plays-100-coin-flips--win-2000-for-each-heads--lose-2000-for-each-tails--we-simulate-millions-of-players-to-understand-the-distribution-of-outcomes" id="toc-game-setupin-this-game--each-player-plays-100-coin-flips--win-2000-for-each-heads--lose-2000-for-each-tails--we-simulate-millions-of-players-to-understand-the-distribution-of-outcomes" class="nav-link" data-scroll-target="#game-setupin-this-game--each-player-plays-100-coin-flips--win-2000-for-each-heads--lose-2000-for-each-tails--we-simulate-millions-of-players-to-understand-the-distribution-of-outcomes">Game SetupIn this game:- Each player plays 100 coin flips- Win ₹2000 for each heads- Lose ₹2000 for each tails- We simulate millions of players to understand the distribution of outcomes</a></li>
  <li><a href="#distribution-of-winningslets-visualize-the-distribution-of-net-money-won-across-all-players" id="toc-distribution-of-winningslets-visualize-the-distribution-of-net-money-won-across-all-players" class="nav-link" data-scroll-target="#distribution-of-winningslets-visualize-the-distribution-of-net-money-won-across-all-players">Distribution of WinningsLet’s visualize the distribution of net money won across all players:</a></li>
  <li><a href="#expected-value-and-variance-analysislets-analyze-the-statistical-properties-of-our-game" id="toc-expected-value-and-variance-analysislets-analyze-the-statistical-properties-of-our-game" class="nav-link" data-scroll-target="#expected-value-and-variance-analysislets-analyze-the-statistical-properties-of-our-game">Expected Value and Variance AnalysisLet’s analyze the statistical properties of our game:</a></li>
  </ul></li>
  <li><a href="#alternative-simulation-approach-individual-coin-flipslets-implement-the-same-game-using-individual-bernoulli-trials-instead-of-the-binomial-distribution-to-verify-our-results" id="toc-alternative-simulation-approach-individual-coin-flipslets-implement-the-same-game-using-individual-bernoulli-trials-instead-of-the-binomial-distribution-to-verify-our-results" class="nav-link" data-scroll-target="#alternative-simulation-approach-individual-coin-flipslets-implement-the-same-game-using-individual-bernoulli-trials-instead-of-the-binomial-distribution-to-verify-our-results">Alternative Simulation Approach: Individual Coin FlipsLet’s implement the same game using individual Bernoulli trials instead of the Binomial distribution to verify our results:</a>
  <ul class="collapse">
  <li><a href="#visualizing-individual-player-trajectorieslets-examine-how-individual-players-fortunes-evolve-over-the-course-of-their-100-coin-flips" id="toc-visualizing-individual-player-trajectorieslets-examine-how-individual-players-fortunes-evolve-over-the-course-of-their-100-coin-flips" class="nav-link" data-scroll-target="#visualizing-individual-player-trajectorieslets-examine-how-individual-players-fortunes-evolve-over-the-course-of-their-100-coin-flips">Visualizing Individual Player TrajectoriesLet’s examine how individual players’ fortunes evolve over the course of their 100 coin flips:</a></li>
  </ul></li>
  <li><a href="#mathematical-properties-variance-and-its-maximumlets-explore-an-important-mathematical-property---when-does-the-variance-of-a-bernoulli-distribution-reach-its-maximum" id="toc-mathematical-properties-variance-and-its-maximumlets-explore-an-important-mathematical-property---when-does-the-variance-of-a-bernoulli-distribution-reach-its-maximum" class="nav-link" data-scroll-target="#mathematical-properties-variance-and-its-maximumlets-explore-an-important-mathematical-property---when-does-the-variance-of-a-bernoulli-distribution-reach-its-maximum">Mathematical Properties: Variance and Its MaximumLet’s explore an important mathematical property - when does the variance of a Bernoulli distribution reach its maximum?</a>
  <ul class="collapse">
  <li><a href="#verifying-expected-value-of-binomial-distributionlets-verify-that-our-simulation-correctly-captures-the-expected-value-of-a-binomial-distribution" id="toc-verifying-expected-value-of-binomial-distributionlets-verify-that-our-simulation-correctly-captures-the-expected-value-of-a-binomial-distribution" class="nav-link" data-scroll-target="#verifying-expected-value-of-binomial-distributionlets-verify-that-our-simulation-correctly-captures-the-expected-value-of-a-binomial-distribution">Verifying Expected Value of Binomial DistributionLet’s verify that our simulation correctly captures the expected value of a Binomial distribution:</a></li>
  </ul></li>
  <li><a href="#advanced-example-expectation-of-gaussian-distributionlets-conclude-with-a-more-advanced-example---computing-the-expected-value-of-a-gaussian-distribution-using-integration.-for-a-standard-normal-distribution-x-sim-mathcaln0-sigma2ex-int_-inftyinfty-x-cdot-frac1sqrt2pisigma2-e-fracx22sigma2-dx-0this-integral-evaluates-to-zero-because-the-function-is-odd-and-symmetric-around-zero." id="toc-advanced-example-expectation-of-gaussian-distributionlets-conclude-with-a-more-advanced-example---computing-the-expected-value-of-a-gaussian-distribution-using-integration.-for-a-standard-normal-distribution-x-sim-mathcaln0-sigma2ex-int_-inftyinfty-x-cdot-frac1sqrt2pisigma2-e-fracx22sigma2-dx-0this-integral-evaluates-to-zero-because-the-function-is-odd-and-symmetric-around-zero." class="nav-link" data-scroll-target="#advanced-example-expectation-of-gaussian-distributionlets-conclude-with-a-more-advanced-example---computing-the-expected-value-of-a-gaussian-distribution-using-integration.-for-a-standard-normal-distribution-x-sim-mathcaln0-sigma2ex-int_-inftyinfty-x-cdot-frac1sqrt2pisigma2-e-fracx22sigma2-dx-0this-integral-evaluates-to-zero-because-the-function-is-odd-and-symmetric-around-zero.">Advanced Example: Expectation of Gaussian DistributionLet’s conclude with a more advanced example - computing the expected value of a Gaussian distribution using integration. For a standard normal distribution <span class="math inline">\(X \sim \mathcal{N}(0, \sigma^2)\)</span>:<span class="math display">\[E[X] = \int_{-\infty}^{\infty} x \cdot \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{x^2}{2\sigma^2}} dx = 0\]</span>This integral evaluates to zero because the function is odd and symmetric around zero.</a></li>
  <li><a href="#summaryin-this-notebook-weve-explored-the-fundamental-concept-of-mathematical-expectation-through1.-theoretical-foundation-understanding-expected-value-as-the-long-run-average2.-law-of-large-numbers-observing-convergence-through-simulation3.-practical-applications-financial-modeling-and-risk-assessment4.-statistical-properties-variance-and-its-relationship-to-expectation5.-advanced-concepts-integration-for-continuous-distributions-key-takeaways--expected-value-provides-the-central-tendency-of-a-random-variable--the-law-of-large-numbers-guarantees-convergence-of-sample-means--variance-measures-the-spread-around-the-expected-value--even-fair-games-zero-expected-value-can-have-high-variance-and-risk--simulation-is-a-powerful-tool-for-understanding-theoretical-concepts-next-steps--explore-conditional-expectation-and-its-applications--study-the-central-limit-theorem-and-its-relationship-to-the-law-of-large-numbers--investigate-more-complex-probability-distributions-and-their-moments--apply-these-concepts-to-real-world-data-analysis-problems" id="toc-summaryin-this-notebook-weve-explored-the-fundamental-concept-of-mathematical-expectation-through1.-theoretical-foundation-understanding-expected-value-as-the-long-run-average2.-law-of-large-numbers-observing-convergence-through-simulation3.-practical-applications-financial-modeling-and-risk-assessment4.-statistical-properties-variance-and-its-relationship-to-expectation5.-advanced-concepts-integration-for-continuous-distributions-key-takeaways--expected-value-provides-the-central-tendency-of-a-random-variable--the-law-of-large-numbers-guarantees-convergence-of-sample-means--variance-measures-the-spread-around-the-expected-value--even-fair-games-zero-expected-value-can-have-high-variance-and-risk--simulation-is-a-powerful-tool-for-understanding-theoretical-concepts-next-steps--explore-conditional-expectation-and-its-applications--study-the-central-limit-theorem-and-its-relationship-to-the-law-of-large-numbers--investigate-more-complex-probability-distributions-and-their-moments--apply-these-concepts-to-real-world-data-analysis-problems" class="nav-link" data-scroll-target="#summaryin-this-notebook-weve-explored-the-fundamental-concept-of-mathematical-expectation-through1.-theoretical-foundation-understanding-expected-value-as-the-long-run-average2.-law-of-large-numbers-observing-convergence-through-simulation3.-practical-applications-financial-modeling-and-risk-assessment4.-statistical-properties-variance-and-its-relationship-to-expectation5.-advanced-concepts-integration-for-continuous-distributions-key-takeaways--expected-value-provides-the-central-tendency-of-a-random-variable--the-law-of-large-numbers-guarantees-convergence-of-sample-means--variance-measures-the-spread-around-the-expected-value--even-fair-games-zero-expected-value-can-have-high-variance-and-risk--simulation-is-a-powerful-tool-for-understanding-theoretical-concepts-next-steps--explore-conditional-expectation-and-its-applications--study-the-central-limit-theorem-and-its-relationship-to-the-law-of-large-numbers--investigate-more-complex-probability-distributions-and-their-moments--apply-these-concepts-to-real-world-data-analysis-problems">SummaryIn this notebook, we’ve explored the fundamental concept of mathematical expectation through:1. <strong>Theoretical Foundation</strong>: Understanding expected value as the long-run average2. <strong>Law of Large Numbers</strong>: Observing convergence through simulation3. <strong>Practical Applications</strong>: Financial modeling and risk assessment4. <strong>Statistical Properties</strong>: Variance and its relationship to expectation5. <strong>Advanced Concepts</strong>: Integration for continuous distributions### Key Takeaways- Expected value provides the central tendency of a random variable- The Law of Large Numbers guarantees convergence of sample means- Variance measures the spread around the expected value- Even fair games (zero expected value) can have high variance and risk- Simulation is a powerful tool for understanding theoretical concepts### Next Steps- Explore conditional expectation and its applications- Study the Central Limit Theorem and its relationship to the Law of Large Numbers- Investigate more complex probability distributions and their moments- Apply these concepts to real-world data analysis problems</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mathematical Expectation and Law of Large Numbers</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Probability</div>
    <div class="quarto-category">Statistics</div>
    <div class="quarto-category">Mathematics</div>
    <div class="quarto-category">Random Variables</div>
  </div>
  </div>

<div>
  <div class="description">
    A comprehensive exploration of mathematical expectation, running averages, and the Law of Large Numbers with practical examples including dice rolls, coin flips, and financial simulations
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nipun Batra </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 13, 2025</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>expectation, law of large numbers, running average, monte carlo simulation, dice simulation, bernoulli distribution, variance</p>
  </div>
</div>

</header>


<p>—author: Nipun Batratitle: Mathematical Expectation and Law of Large Numbersdescription: A comprehensive exploration of mathematical expectation, running averages, and the Law of Large Numbers with practical examples including dice rolls, coin flips, and financial simulationscategories: - Probability - Statistics - Mathematics - Random Variableskeywords: - expectation - law of large numbers - running average - monte carlo simulation - dice simulation - bernoulli distribution - variancedate: ’2025-01-13’badges: truetoc: true—# Mathematical Expectation and Law of Large Numbers## Learning ObjectivesBy the end of this notebook, you will understand:1. <strong>Mathematical Expectation</strong>: The concept of expected value as the long-run average of a random variable2. <strong>Law of Large Numbers</strong>: How sample averages converge to the theoretical expectation as sample size increases3. <strong>Running Averages</strong>: How to compute and visualize convergence in real-time simulations4. <strong>Practical Applications</strong>: Real-world examples including financial modeling and game theory5. <strong>Variance and Risk</strong>: Understanding the relationship between expected value and variability## IntroductionMathematical expectation is one of the most fundamental concepts in probability theory and statistics. It represents the “center” or average value we expect from a random variable over many trials. While a single observation from a random variable can vary widely, the Law of Large Numbers guarantees that the average of many observations will converge to the theoretical expectation.This notebook explores these concepts through interactive simulations and practical examples, including:- Dice rolling simulations demonstrating convergence to expected value- Financial modeling with coin flip games- Monte Carlo methods for numerical estimation- Real-world applications in risk assessment and decision makingLet’s start by setting up our computational environment and then dive into the fascinating world of mathematical expectation!</p>
<section id="setting-up-the-environmentwell-use-pytorch-for-probability-distributions-numpy-for-numerical-computations-pandas-for-data-manipulation-and-matplotlib-for-visualizations." class="level2">
<h2 class="anchored" data-anchor-id="setting-up-the-environmentwell-use-pytorch-for-probability-distributions-numpy-for-numerical-computations-pandas-for-data-manipulation-and-matplotlib-for-visualizations.">Setting Up the EnvironmentWe’ll use PyTorch for probability distributions, NumPy for numerical computations, Pandas for data manipulation, and Matplotlib for visualizations.</h2>
</section>
<section id="dice-rolling-simulation-understanding-expected-valuelets-start-with-a-classic-example---rolling-a-fair-six-sided-die.-the-theoretical-expected-value-of-a-fair-die-isex-frac1-2-3-4-5-66-frac216-3.5even-though-we-can-never-actually-roll-a-3.5-this-is-the-average-value-we-expect-over-many-rolls." class="level2">
<h2 class="anchored" data-anchor-id="dice-rolling-simulation-understanding-expected-valuelets-start-with-a-classic-example---rolling-a-fair-six-sided-die.-the-theoretical-expected-value-of-a-fair-die-isex-frac1-2-3-4-5-66-frac216-3.5even-though-we-can-never-actually-roll-a-3.5-this-is-the-average-value-we-expect-over-many-rolls.">Dice Rolling Simulation: Understanding Expected ValueLet’s start with a classic example - rolling a fair six-sided die. The theoretical expected value of a fair die is:<span class="math display">\[E[X] = \frac{1 + 2 + 3 + 4 + 5 + 6}{6} = \frac{21}{6} = 3.5\]</span>Even though we can never actually roll a 3.5, this is the average value we expect over many rolls.</h2>
<div id="cell-3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.distributions <span class="im">as</span> dist</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">'retina'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dice <span class="op">=</span> dist.Categorical(probs<span class="op">=</span>torch.tensor([<span class="dv">1</span><span class="op">/</span><span class="dv">6</span>]<span class="op">*</span><span class="dv">6</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample N dice rolls</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>rolls <span class="op">=</span> dice.sample((N,)) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 is added to the sample because the sample is 0-indexed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="observing-individual-dice-rollslets-examine-the-frequency-distribution-of-our-dice-rolls-to-see-how-they-compare-to-the-theoretical-uniform-distribution" class="level3">
<h3 class="anchored" data-anchor-id="observing-individual-dice-rollslets-examine-the-frequency-distribution-of-our-dice-rolls-to-see-how-they-compare-to-the-theoretical-uniform-distribution">Observing Individual Dice RollsLet’s examine the frequency distribution of our dice rolls to see how they compare to the theoretical uniform distribution:</h3>
</section>
<section id="computing-running-averagesnow-lets-compute-the-running-average-to-see-how-it-converges-to-the-theoretical-expectation-of-3.5" class="level3">
<h3 class="anchored" data-anchor-id="computing-running-averagesnow-lets-compute-the-running-average-to-see-how-it-converges-to-the-theoretical-expectation-of-3.5">Computing Running AveragesNow let’s compute the running average to see how it converges to the theoretical expectation of 3.5:</h3>
<p>The red dashed line shows the theoretical expected value of 3.5. Notice how the running average oscillates around this value and gradually converges to it as the number of rolls increases. This is a visual demonstration of the <strong>Law of Large Numbers</strong>.</p>
<div id="cell-8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rolls[:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>tensor([2, 3, 2, 2, 5, 5, 5, 5, 2, 2])</code></pre>
</div>
</div>
</section>
</section>
<section id="bernoulli-distribution-and-expected-valuelets-explore-the-bernoulli-distribution-which-models-binary-outcomes-successfailure-headstails-etc..-for-a-bernoulli-random-variable-with-probability-p-of-successex-1-cdot-p-0-cdot-1-p-pso-for-a-fair-coin-p-0.5-the-expected-value-is-0.5." class="level2">
<h2 class="anchored" data-anchor-id="bernoulli-distribution-and-expected-valuelets-explore-the-bernoulli-distribution-which-models-binary-outcomes-successfailure-headstails-etc..-for-a-bernoulli-random-variable-with-probability-p-of-successex-1-cdot-p-0-cdot-1-p-pso-for-a-fair-coin-p-0.5-the-expected-value-is-0.5.">Bernoulli Distribution and Expected ValueLet’s explore the Bernoulli distribution, which models binary outcomes (success/failure, heads/tails, etc.). For a Bernoulli random variable with probability <span class="math inline">\(p\)</span> of success:<span class="math display">\[E[X] = 1 \cdot p + 0 \cdot (1-p) = p\]</span>So for a fair coin (<span class="math inline">\(p = 0.5\)</span>), the expected value is 0.5.</h2>
<div id="cell-10" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ax.plot(rolls, lw<span class="op">=</span><span class="fl">0.5</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Roll number'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Text(0.5, 0, 'Roll number')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="expectation_files/figure-html/cell-5-output-2.png" width="968" height="371" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pd.Series(rolls).value_counts().sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>1    183
2    160
3    188
4    148
5    165
6    156
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="financial-application-coin-flip-gamenow-lets-explore-a-more-complex-application---a-financial-game-based-on-coin-flips.-this-demonstrates-how-expectation-and-variance-work-together-in-risk-assessment." class="level2">
<h2 class="anchored" data-anchor-id="financial-application-coin-flip-gamenow-lets-explore-a-more-complex-application---a-financial-game-based-on-coin-flips.-this-demonstrates-how-expectation-and-variance-work-together-in-risk-assessment.">Financial Application: Coin Flip GameNow let’s explore a more complex application - a financial game based on coin flips. This demonstrates how expectation and variance work together in risk assessment.</h2>
<section id="game-setupin-this-game--each-player-plays-100-coin-flips--win-2000-for-each-heads--lose-2000-for-each-tails--we-simulate-millions-of-players-to-understand-the-distribution-of-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="game-setupin-this-game--each-player-plays-100-coin-flips--win-2000-for-each-heads--lose-2000-for-each-tails--we-simulate-millions-of-players-to-understand-the-distribution-of-outcomes">Game SetupIn this game:- Each player plays 100 coin flips- Win ₹2000 for each heads- Lose ₹2000 for each tails- We simulate millions of players to understand the distribution of outcomes</h3>
<div id="cell-14" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running average</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>runing_avg <span class="op">=</span> torch.cumsum(rolls, dim<span class="op">=</span><span class="dv">0</span>) <span class="op">/</span> torch.arange(<span class="dv">1</span>, N<span class="op">+</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-15" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plt.plot(runing_avg, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Roll number'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Running average'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="fl">3.5</span>, color<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="dv">1</span>, ls<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="expectation_files/figure-html/cell-8-output-1.png" width="576" height="432" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_running_avg(N):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rolls <span class="op">=</span> dice.sample((N,)) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    runing_avg <span class="op">=</span> torch.cumsum(rolls, dim<span class="op">=</span><span class="dv">0</span>) <span class="op">/</span> torch.arange(<span class="dv">1</span>, N<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> runing_avg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-17" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> torch.distributions.Bernoulli(probs<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> dist.sample((<span class="dv">100</span>,))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-18" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>samples.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>tensor(0.5100)</code></pre>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pd.Series(samples.numpy()).value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>1.0    51
0.0    49
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Game of winning and losing money based on a coin flip</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-21" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>win_amt <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>loss_amt <span class="op">=</span> <span class="op">-</span><span class="dv">2000</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>total_count_N <span class="op">=</span> <span class="dv">100</span> <span class="co"># Number of coin flips</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> torch.distributions.Binomial(total_count_N, probs<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-22" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">5000000</span> <span class="co"># number of players/Number of times we perform total_count_N coin flips</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="distribution-of-winningslets-visualize-the-distribution-of-net-money-won-across-all-players" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-winningslets-visualize-the-distribution-of-net-money-won-across-all-players">Distribution of WinningsLet’s visualize the distribution of net money won across all players:</h3>
</section>
<section id="expected-value-and-variance-analysislets-analyze-the-statistical-properties-of-our-game" class="level3">
<h3 class="anchored" data-anchor-id="expected-value-and-variance-analysislets-analyze-the-statistical-properties-of-our-game">Expected Value and Variance AnalysisLet’s analyze the statistical properties of our game:</h3>
<div id="cell-25" class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>num_times_wins_across_samples <span class="op">=</span> dist.sample((num_samples,))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The ratio close to 1 confirms that our simulation matches the theoretical variance formula for the sum of independent random variables.</p>
</section>
</section>
<section id="alternative-simulation-approach-individual-coin-flipslets-implement-the-same-game-using-individual-bernoulli-trials-instead-of-the-binomial-distribution-to-verify-our-results" class="level2">
<h2 class="anchored" data-anchor-id="alternative-simulation-approach-individual-coin-flipslets-implement-the-same-game-using-individual-bernoulli-trials-instead-of-the-binomial-distribution-to-verify-our-results">Alternative Simulation Approach: Individual Coin FlipsLet’s implement the same game using individual Bernoulli trials instead of the Binomial distribution to verify our results:</h2>
<div id="cell-28" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>num_times_wins_across_samples[:<span class="dv">100</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>tensor([46., 54., 58., 58., 58., 55., 55., 47., 50., 54., 54., 40., 52., 54.,
        54., 44., 49., 53., 59., 43., 54., 47., 53., 46., 45., 55., 50., 48.,
        51., 56., 49., 42., 50., 52., 48., 53., 58., 47., 46., 46., 58., 60.,
        40., 44., 53., 47., 50., 52., 42., 50., 45., 52., 52., 51., 46., 33.,
        53., 52., 49., 42., 52., 44., 56., 49., 51., 55., 50., 53., 57., 50.,
        49., 53., 56., 53., 49., 48., 55., 50., 50., 48., 59., 53., 54., 37.,
        48., 57., 41., 60., 55., 59., 53., 55., 50., 46., 51., 47., 51., 44.,
        43., 55.])</code></pre>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> num_samples<span class="op">&lt;=</span><span class="dv">50</span>:</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    pd.Series(num_times_wins_across_samples.numpy()).plot(kind<span class="op">=</span><span class="st">'bar'</span>, rot<span class="op">=</span><span class="dv">0</span>, ax<span class="op">=</span>ax)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Sample number'</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of wins'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-30" class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>net_money_won <span class="op">=</span> num_times_wins_across_samples <span class="op">*</span> win_amt <span class="op">+</span> (total_count_N <span class="op">-</span> num_times_wins_across_samples) <span class="op">*</span> loss_amt</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>net_money_won_series <span class="op">=</span> pd.Series(net_money_won.numpy())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-31" class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>net_money_won_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="181">
<pre><code>0         -16000.0
1          16000.0
2          32000.0
3          32000.0
4          32000.0
            ...   
4999995   -16000.0
4999996    52000.0
4999997   -44000.0
4999998    -4000.0
4999999   -20000.0
Length: 5000000, dtype: float32</code></pre>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>net_money_won_series.var()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="182">
<pre><code>399787200.0</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>net_money_won_series.<span class="bu">max</span>() <span class="op">-</span> net_money_won_series.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="183">
<pre><code>192000.0</code></pre>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> num_samples<span class="op">&lt;=</span><span class="dv">50</span>:</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    net_money_won_series.plot(kind<span class="op">=</span><span class="st">'bar'</span>, rot<span class="op">=</span><span class="dv">0</span>, ax<span class="op">=</span>ax)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="dv">1</span>, ls<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>net_money_won_series.hist(grid<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="expectation_files/figure-html/cell-24-output-1.png" width="579" height="428" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>net_money_won_series.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="186">
<pre><code>-6.3688</code></pre>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>net_money_won_series.var()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>399787200.0</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>net_money_won_series.var()<span class="op">/</span>((win_amt<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> total_count_N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">
<pre><code>0.999468</code></pre>
</div>
</div>
<section id="visualizing-individual-player-trajectorieslets-examine-how-individual-players-fortunes-evolve-over-the-course-of-their-100-coin-flips" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-individual-player-trajectorieslets-examine-how-individual-players-fortunes-evolve-over-the-course-of-their-100-coin-flips">Visualizing Individual Player TrajectoriesLet’s examine how individual players’ fortunes evolve over the course of their 100 coin flips:</h3>
<div id="cell-40" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same analysis but starting from Bernoulli distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This powerful visualization shows all player trajectories in gray (left) and the final distribution of outcomes (right). Notice how most trajectories cluster around zero net winnings, consistent with the fair game’s expected value of zero.</p>
</section>
</section>
<section id="mathematical-properties-variance-and-its-maximumlets-explore-an-important-mathematical-property---when-does-the-variance-of-a-bernoulli-distribution-reach-its-maximum" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-properties-variance-and-its-maximumlets-explore-an-important-mathematical-property---when-does-the-variance-of-a-bernoulli-distribution-reach-its-maximum">Mathematical Properties: Variance and Its MaximumLet’s explore an important mathematical property - when does the variance of a Bernoulli distribution reach its maximum?</h2>
<section id="verifying-expected-value-of-binomial-distributionlets-verify-that-our-simulation-correctly-captures-the-expected-value-of-a-binomial-distribution" class="level3">
<h3 class="anchored" data-anchor-id="verifying-expected-value-of-binomial-distributionlets-verify-that-our-simulation-correctly-captures-the-expected-value-of-a-binomial-distribution">Verifying Expected Value of Binomial DistributionLet’s verify that our simulation correctly captures the expected value of a Binomial distribution:</h3>
<div id="cell-44" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>win_amt <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>loss_amt <span class="op">=</span> <span class="op">-</span><span class="dv">2000</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>total_count_N <span class="op">=</span> <span class="dv">100</span> <span class="co"># Number of coin flips</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate game</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> torch.distributions.Bernoulli(probs<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="advanced-example-expectation-of-gaussian-distributionlets-conclude-with-a-more-advanced-example---computing-the-expected-value-of-a-gaussian-distribution-using-integration.-for-a-standard-normal-distribution-x-sim-mathcaln0-sigma2ex-int_-inftyinfty-x-cdot-frac1sqrt2pisigma2-e-fracx22sigma2-dx-0this-integral-evaluates-to-zero-because-the-function-is-odd-and-symmetric-around-zero." class="level2">
<h2 class="anchored" data-anchor-id="advanced-example-expectation-of-gaussian-distributionlets-conclude-with-a-more-advanced-example---computing-the-expected-value-of-a-gaussian-distribution-using-integration.-for-a-standard-normal-distribution-x-sim-mathcaln0-sigma2ex-int_-inftyinfty-x-cdot-frac1sqrt2pisigma2-e-fracx22sigma2-dx-0this-integral-evaluates-to-zero-because-the-function-is-odd-and-symmetric-around-zero.">Advanced Example: Expectation of Gaussian DistributionLet’s conclude with a more advanced example - computing the expected value of a Gaussian distribution using integration. For a standard normal distribution <span class="math inline">\(X \sim \mathcal{N}(0, \sigma^2)\)</span>:<span class="math display">\[E[X] = \int_{-\infty}^{\infty} x \cdot \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{x^2}{2\sigma^2}} dx = 0\]</span>This integral evaluates to zero because the function is odd and symmetric around zero.</h2>
</section>
<section id="summaryin-this-notebook-weve-explored-the-fundamental-concept-of-mathematical-expectation-through1.-theoretical-foundation-understanding-expected-value-as-the-long-run-average2.-law-of-large-numbers-observing-convergence-through-simulation3.-practical-applications-financial-modeling-and-risk-assessment4.-statistical-properties-variance-and-its-relationship-to-expectation5.-advanced-concepts-integration-for-continuous-distributions-key-takeaways--expected-value-provides-the-central-tendency-of-a-random-variable--the-law-of-large-numbers-guarantees-convergence-of-sample-means--variance-measures-the-spread-around-the-expected-value--even-fair-games-zero-expected-value-can-have-high-variance-and-risk--simulation-is-a-powerful-tool-for-understanding-theoretical-concepts-next-steps--explore-conditional-expectation-and-its-applications--study-the-central-limit-theorem-and-its-relationship-to-the-law-of-large-numbers--investigate-more-complex-probability-distributions-and-their-moments--apply-these-concepts-to-real-world-data-analysis-problems" class="level2">
<h2 class="anchored" data-anchor-id="summaryin-this-notebook-weve-explored-the-fundamental-concept-of-mathematical-expectation-through1.-theoretical-foundation-understanding-expected-value-as-the-long-run-average2.-law-of-large-numbers-observing-convergence-through-simulation3.-practical-applications-financial-modeling-and-risk-assessment4.-statistical-properties-variance-and-its-relationship-to-expectation5.-advanced-concepts-integration-for-continuous-distributions-key-takeaways--expected-value-provides-the-central-tendency-of-a-random-variable--the-law-of-large-numbers-guarantees-convergence-of-sample-means--variance-measures-the-spread-around-the-expected-value--even-fair-games-zero-expected-value-can-have-high-variance-and-risk--simulation-is-a-powerful-tool-for-understanding-theoretical-concepts-next-steps--explore-conditional-expectation-and-its-applications--study-the-central-limit-theorem-and-its-relationship-to-the-law-of-large-numbers--investigate-more-complex-probability-distributions-and-their-moments--apply-these-concepts-to-real-world-data-analysis-problems">SummaryIn this notebook, we’ve explored the fundamental concept of mathematical expectation through:1. <strong>Theoretical Foundation</strong>: Understanding expected value as the long-run average2. <strong>Law of Large Numbers</strong>: Observing convergence through simulation3. <strong>Practical Applications</strong>: Financial modeling and risk assessment4. <strong>Statistical Properties</strong>: Variance and its relationship to expectation5. <strong>Advanced Concepts</strong>: Integration for continuous distributions### Key Takeaways- Expected value provides the central tendency of a random variable- The Law of Large Numbers guarantees convergence of sample means- Variance measures the spread around the expected value- Even fair games (zero expected value) can have high variance and risk- Simulation is a powerful tool for understanding theoretical concepts### Next Steps- Explore conditional expectation and its applications- Study the Central Limit Theorem and its relationship to the Law of Large Numbers- Investigate more complex probability distributions and their moments- Apply these concepts to real-world data analysis problems</h2>
<div id="cell-48" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>overall_samples <span class="op">=</span> dist.sample(torch.Size([num_samples, total_count_N]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-49" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>overall_samples.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>torch.Size([5000, 100])</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>overall_samples_df <span class="op">=</span> pd.DataFrame(overall_samples.numpy())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-51" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>overall_samples_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">90</th>
<th data-quarto-table-cell-role="th">91</th>
<th data-quarto-table-cell-role="th">92</th>
<th data-quarto-table-cell-role="th">93</th>
<th data-quarto-table-cell-role="th">94</th>
<th data-quarto-table-cell-role="th">95</th>
<th data-quarto-table-cell-role="th">96</th>
<th data-quarto-table-cell-role="th">97</th>
<th data-quarto-table-cell-role="th">98</th>
<th data-quarto-table-cell-role="th">99</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>...</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>...</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 100 columns</p>
</div>
</div>
</div>
<div id="cell-52" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># win and loss -- replace 0 with -2000 and 1 with 2000</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>win_amount_df <span class="op">=</span> overall_samples_df.replace({<span class="dv">0</span>: loss_amt, <span class="dv">1</span>: win_amt})</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>win_amount_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">90</th>
<th data-quarto-table-cell-role="th">91</th>
<th data-quarto-table-cell-role="th">92</th>
<th data-quarto-table-cell-role="th">93</th>
<th data-quarto-table-cell-role="th">94</th>
<th data-quarto-table-cell-role="th">95</th>
<th data-quarto-table-cell-role="th">96</th>
<th data-quarto-table-cell-role="th">97</th>
<th data-quarto-table-cell-role="th">98</th>
<th data-quarto-table-cell-role="th">99</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>...</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>...</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>...</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>...</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>...</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
<td>-2000.0</td>
<td>2000.0</td>
<td>2000.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 100 columns</p>
</div>
</div>
</div>
<div id="cell-53" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Net money won</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>net_money_won <span class="op">=</span> win_amount_df.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>net_money_won</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>0       16000.0
1       -4000.0
2       40000.0
3       24000.0
4       -4000.0
         ...   
4995        0.0
4996   -12000.0
4997    16000.0
4998    12000.0
4999    40000.0
Length: 5000, dtype: float32</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>net_money_won.hist(grid<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="expectation_files/figure-html/cell-37-output-1.png" width="560" height="413" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>net_money_won.var()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>397101630.0</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>net_money_won.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>561.6</code></pre>
</div>
</div>
<div id="cell-57" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting cumulative sum of net money won for first 5 players</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#win_amount_df.iloc[i].values.cumsum()</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    ax.plot(win_amount_df.iloc[i].values.cumsum(), lw<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="expectation_files/figure-html/cell-40-output-1.png" width="1015" height="351" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-58" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>cumsum_df <span class="op">=</span> win_amount_df.cumsum(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>cumsum_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">90</th>
<th data-quarto-table-cell-role="th">91</th>
<th data-quarto-table-cell-role="th">92</th>
<th data-quarto-table-cell-role="th">93</th>
<th data-quarto-table-cell-role="th">94</th>
<th data-quarto-table-cell-role="th">95</th>
<th data-quarto-table-cell-role="th">96</th>
<th data-quarto-table-cell-role="th">97</th>
<th data-quarto-table-cell-role="th">98</th>
<th data-quarto-table-cell-role="th">99</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-2000.0</td>
<td>-4000.0</td>
<td>-2000.0</td>
<td>-4000.0</td>
<td>-2000.0</td>
<td>0.0</td>
<td>2000.0</td>
<td>4000.0</td>
<td>6000.0</td>
<td>4000.0</td>
<td>...</td>
<td>10000.0</td>
<td>8000.0</td>
<td>10000.0</td>
<td>12000.0</td>
<td>14000.0</td>
<td>16000.0</td>
<td>18000.0</td>
<td>16000.0</td>
<td>14000.0</td>
<td>16000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-2000.0</td>
<td>-4000.0</td>
<td>-6000.0</td>
<td>-4000.0</td>
<td>-2000.0</td>
<td>-4000.0</td>
<td>-2000.0</td>
<td>-4000.0</td>
<td>-6000.0</td>
<td>-4000.0</td>
<td>...</td>
<td>-6000.0</td>
<td>-4000.0</td>
<td>-2000.0</td>
<td>-4000.0</td>
<td>-6000.0</td>
<td>-4000.0</td>
<td>-6000.0</td>
<td>-4000.0</td>
<td>-6000.0</td>
<td>-4000.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-2000.0</td>
<td>0.0</td>
<td>2000.0</td>
<td>4000.0</td>
<td>6000.0</td>
<td>8000.0</td>
<td>6000.0</td>
<td>4000.0</td>
<td>6000.0</td>
<td>8000.0</td>
<td>...</td>
<td>30000.0</td>
<td>32000.0</td>
<td>30000.0</td>
<td>32000.0</td>
<td>34000.0</td>
<td>36000.0</td>
<td>38000.0</td>
<td>36000.0</td>
<td>38000.0</td>
<td>40000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000.0</td>
<td>4000.0</td>
<td>6000.0</td>
<td>4000.0</td>
<td>2000.0</td>
<td>0.0</td>
<td>2000.0</td>
<td>4000.0</td>
<td>2000.0</td>
<td>0.0</td>
<td>...</td>
<td>22000.0</td>
<td>20000.0</td>
<td>18000.0</td>
<td>20000.0</td>
<td>22000.0</td>
<td>20000.0</td>
<td>22000.0</td>
<td>24000.0</td>
<td>26000.0</td>
<td>24000.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-2000.0</td>
<td>0.0</td>
<td>-2000.0</td>
<td>-4000.0</td>
<td>-6000.0</td>
<td>-4000.0</td>
<td>-2000.0</td>
<td>-4000.0</td>
<td>-6000.0</td>
<td>-4000.0</td>
<td>...</td>
<td>-10000.0</td>
<td>-12000.0</td>
<td>-10000.0</td>
<td>-12000.0</td>
<td>-10000.0</td>
<td>-8000.0</td>
<td>-6000.0</td>
<td>-8000.0</td>
<td>-6000.0</td>
<td>-4000.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 100 columns</p>
</div>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> fig.add_gridspec(<span class="dv">1</span>, <span class="dv">2</span>, width_ratios<span class="op">=</span>[<span class="dv">4</span>, <span class="dv">1</span>])  <span class="co"># 4:1 ratio for main plot and histogram</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Main plot (left plot for cumulative sum)</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>])</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>cumsum_df <span class="op">=</span> win_amount_df.cumsum(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>cumsum_df.T.plot(legend<span class="op">=</span><span class="va">False</span>, lw<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">'k'</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">"Number of coin flips"</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">"Net money won"</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Right plot (histogram)</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>])</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>ax2.hist(net_money_won, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, orientation<span class="op">=</span><span class="st">'horizontal'</span>, bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">"Frequency"</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust layout</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'coin_flip_game.png'</span>, dpi<span class="op">=</span><span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="expectation_files/figure-html/cell-42-output-1.png" width="1389" height="589" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>plt.plot(p, p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p), label<span class="op">=</span><span class="st">'p(1-p)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="expectation_files/figure-html/cell-43-output-1.png" width="556" height="413" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-61" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> torch.distributions.Binomial(total_count<span class="op">=</span><span class="dv">2</span>, probs<span class="op">=</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-62" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">100000000</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> dist.sample((N,))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-63" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>samples.mean().item()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0.9999343752861023</code></pre>
</div>
</div>
<div id="cell-64" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Finding the mean of Gaussian distrubution</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>y_lin <span class="op">=</span> torch.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> y_lin<span class="op">*</span>torch.exp(<span class="op">-</span>y_lin<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>plt.plot(y_lin, out)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Drawing coordinate axis at x = 0, y = 0</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>plt.fill_between(y_lin, out, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="expectation_files/figure-html/cell-47-output-1.png" width="559" height="413" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/nipunbatra\.github\.io\/psdv-teaching\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>